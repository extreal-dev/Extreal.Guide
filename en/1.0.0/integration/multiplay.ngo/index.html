<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.0.0 docs-doc-page docs-doc-id-integration/multiplay.ngo" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Multiplay using Netcode for GameObjects | Extreal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://extreal-dev.github.io/Extreal.Guide/en/1.0.0/integration/multiplay.ngo"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.0.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.0.0"><meta data-rh="true" name="docsearch:version" content="1.0.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.0.0"><meta data-rh="true" property="og:title" content="Multiplay using Netcode for GameObjects | Extreal"><meta data-rh="true" name="description" content="What for?"><meta data-rh="true" property="og:description" content="What for?"><link data-rh="true" rel="icon" href="/Extreal.Guide/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://extreal-dev.github.io/Extreal.Guide/en/1.0.0/integration/multiplay.ngo"><link data-rh="true" rel="alternate" href="https://extreal-dev.github.io/Extreal.Guide/1.0.0/integration/multiplay.ngo" hreflang="ja"><link data-rh="true" rel="alternate" href="https://extreal-dev.github.io/Extreal.Guide/en/1.0.0/integration/multiplay.ngo" hreflang="en"><link data-rh="true" rel="alternate" href="https://extreal-dev.github.io/Extreal.Guide/1.0.0/integration/multiplay.ngo" hreflang="x-default"><script src="https://plausible.io/js/script.js" defer="defer" data-domain="extreal-dev.github.io,all.fintan"></script>
<script src="/Extreal.Guide/js/custom.js"></script>
<script src="/Extreal.Guide/en/js/custom.js"></script><link rel="stylesheet" href="/Extreal.Guide/en/assets/css/styles.bb6e314e.css">
<script src="/Extreal.Guide/en/assets/js/runtime~main.daf27f9c.js" defer="defer"></script>
<script src="/Extreal.Guide/en/assets/js/main.204b57dc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://fintan.jp" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/Extreal.Guide/en/img/fintan-logo.jpg" alt="Fintan" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Extreal.Guide/en/img/fintan-logo.jpg" alt="Fintan" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/Extreal.Guide/en/">Extreal</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Extreal.Guide/en/1.0.0/intro">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/Extreal.Guide/en/1.0.0/intro">1.0.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Extreal.Guide/en/next/integration/multiplay.ngo">Next</a></li><li><a class="dropdown__link" href="/Extreal.Guide/en/integration/multiplay.ngo">1.2.0</a></li><li><a class="dropdown__link" href="/Extreal.Guide/en/1.1.0/integration/multiplay.ngo">1.1.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/Extreal.Guide/en/1.0.0/integration/multiplay.ngo">1.0.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/Extreal.Guide/1.0.0/integration/multiplay.ngo" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/Extreal.Guide/en/1.0.0/integration/multiplay.ngo" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://fintan.jp/blog-category/xr/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Fintan - XR<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/extreal-dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Extreal.Guide/en/1.0.0/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Extreal.Guide/en/1.0.0/category/release">Release</a><button aria-label="Expand sidebar category &#x27;Release&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Extreal.Guide/en/1.0.0/category/core">Core</a><button aria-label="Expand sidebar category &#x27;Core&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/Extreal.Guide/en/1.0.0/category/integration">Integration</a><button aria-label="Collapse sidebar category &#x27;Integration&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Extreal.Guide/en/1.0.0/integration/chat.vivox">Chat using Vivox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Extreal.Guide/en/1.0.0/integration/multiplay.ngo">Multiplay using Netcode for GameObjects</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Extreal.Guide/en/1.0.0/category/sample-application">Sample Application</a><button aria-label="Expand sidebar category &#x27;Sample Application&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Extreal.Guide/en/1.0.0/category/learning">Learning</a><button aria-label="Expand sidebar category &#x27;Learning&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Extreal.Guide/en/1.0.0/category/legal">Legal</a><button aria-label="Expand sidebar category &#x27;Legal&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Extreal<!-- --> <b>1.0.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/Extreal.Guide/en/integration/multiplay.ngo">latest version</a></b> (<!-- -->1.2.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Extreal.Guide/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Extreal.Guide/en/1.0.0/category/integration"><span itemprop="name">Integration</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Multiplay using Netcode for GameObjects</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.0.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1 id="multiplay-using-netcode-for-gameobjects">Multiplay using Netcode for GameObjects</h1>
<h2 id="what-for">What for?</h2>
<p>We provide a wrapper that makes <a href="https://docs-multiplayer.unity3d.com/netcode/current/about/index.html">Netcode for GameObjects</a> easier to use in your application.</p>
<p>In Extreal, Netcode for GameObjects is called NGO, and this feature that wraps NGO is called the NGO wrapper.</p>
<p>NGO provides server and client features in a single class called NetworkManager.
Since using NetworkManager as-is always requires context-aware implementation and can be confusing, the NGO wrapper provides NgoServer and NgoClient as separate classes for the server and client, respectively.</p>
<p>The goal is to make NGO introduction smooth by using the NGO wrapper in your applications.</p>
<admonition type="caution"><p>The NGO wrapper makes NGO easier to use, but it does not mean that you only need to know the NGO wrapper to realize multiplayer without knowing NGO.
The NGO wrapper compensates for the difficulties or lack of features when using NGO as it is, but transfers the multiplayer process to NGO.
Therefore, to use the NGO wrapper, it is assumed that you know NGO.
If you do not know NGO, please refer to <a href="/Extreal.Guide/en/1.0.0/learning/intro#multiplayer">Learning</a> to learn about NGO.
This guide assumes you know NGO.</p></admonition>
<admonition type="info"><p>Example implementations of NGO wrappers for common multiplayer application requirements are provided in <a href="../category/sample-application">sample applications</a>.</p><p>At this time, the following requirements have been provided.</p><ul>
<li>The user can play with an avatar of the user&#x27;s choice</li>
<li>If the maximum number of people in the space is exceeded, users will not be able to enter the room</li>
</ul><p>The following requirements will be added in the future.</p><ul>
<li>The system reconnects in case of unexpected network disconnection</li>
<li>The system allows users to wait until the maximum number of people on standby is exceeded if the maximum number of people in a space is exceeded<!-- -->
<ul>
<li>The users on standby is hidden, while other users&#x27; multiplayer is visible</li>
</ul>
</li>
<li>When other users leave the room and take their turn, they can join the multiplayer</li>
<li>Users can play avatars offline as well as online</li>
<li>Avatars can have objects</li>
</ul></admonition>
<h2 id="specification">Specification</h2>
<p>The specifications of the NGO Wrapper are as follows.</p>
<ul>
<li>You can use features for NGO servers.</li>
<li>You can add processing triggered by NGO server state.</li>
<li>You can use features for NGO clients.</li>
<li>You can add processing triggered by NGO client state.</li>
<li>You can support any NetworkTransport other than the default one provided by the NGO.</li>
</ul>
<admonition type="info"><p>The NGO wrapper supports the two transports provided by NGO (Unity Transport and UNet Transport), so no additional action is required if you use these two transports.
When using a new transport not provided by NGO, the IConnectionSetter used by NgoClient must be changed.
See <a href="#int-ngo-nt">Supporting non-default NetworkTransport provided by NGO</a> for details.</p></admonition>
<admonition type="info"><p>Because it is easier to ensure stable performance and security, the NGO wrapper assumes the use of a dedicated server as the NGO architecture.
For more information on NGO architecture, see <a href="https://docs-multiplayer.unity3d.com/netcode/current/terms-concepts/network-topologies">Network Topologies</a>.
Because it assumes the use of a dedicated server, the NGO wrapper does not provide features for the host.
If you want to use them, please use NetworkManager directly.</p></admonition>
<h2 id="architecture">Architecture</h2>
<mermaid chart="classDiagram

    NetworkManager &lt;.. NgoServer
    NetworkManager &lt;.. NgoClient
    NgoClient ..&gt; NgoConfig
    NgoClient ..&gt; IConnectionSetter
    IConnectionSetter &lt;|.. UnityTransportConnectionSetter
    IConnectionSetter &lt;|.. UNetTransportConnectionSetter
    IDisposable &lt;|.. NgoServer
    IDisposable &lt;|.. NgoClient

    class NetworkManager {
        &lt;&lt;NGO&gt;&gt;
    }

    class NgoServer {
        +OnServerStarted IObservable
        +OnServerStopping IObservable
        +OnClientConnected IObservable
        +OnClientDisconnecting IObservable
        +OnClientRemoving IObservable
        +ConnectedClients IReadOnlyDictionary
        +NgoServer(networkManager)
        +StartServerAsync(cancellationToken) void
        +StopServerAsync() void
        +SetConnectionApprovalCallback(connectionApprovalCallback) void
        +RemoveClient(clientId) bool
        +SendMessageToClients(clientIds, messageName, messageStream, networkDelivery) void
        +SendMessageToAllClients(messageName, messageStream, networkDelivery) void
        +RegisterMessageHandler(messageName, messageHandler) void
        +UnregisterMessageHandler(messageName) void
        +SetVisibilityDelegate(visibilityDelegate) void
        +SpawnWithServerOwnership(prefab, position, rotation, parent, worldPositionStays) GameObject
        +SpawnWithClientOwnership(ownerClientId, prefab, position, rotation, parent, worldPositionStays) GameObject
        +SpawnAsPlayerObject(ownerClientId, prefab, position, rotation, parent, worldPositionStays) GameObject
    }

    class NgoClient {
        +OnConnected IObservable
        +OnDisconnecting IObservable
        +OnUnexpectedDisconnected IObservable
        +OnConnectionApprovalRejected IObservable
        +NgoClient(networkManager)
        +AddConnectionSetter(connectionSetter) void
        +ConnectAsync(ngoConfig, cancellationToken) bool
        +DisconnectAsync() void
        +SendMessage(messageName, messageStream, networkDelivery) void
        +RegisterMessageHandler(messageName, messageHandler) void
        +UnregisterMessageHandler(messageName) void
    }

    class NgoConfig {
        +Address string
        +Port ushort
        +ConnectionData byte[]
        +Timeout TimeSpan
        +NgoConfig(address, port, connectionData, timeout)
    }

    class IConnectionSetter {
        &lt;&lt;interface&gt;&gt;
        +TargetType Type
        +Set(networkTransport, ngoConfig)
    }

    class UnityTransportConnectionSetter {
    }

    class UNetTransportConnectionSetter {
    }

    class IDisposable {
        &lt;&lt;system&gt;&gt;
    }"></mermaid>
<h2 id="installation">Installation</h2>
<h3 id="package">Package</h3>
<pre><code class="language-text">https://github.com/extreal-dev/Extreal.Integration.Multiplay.NGO.git
</code></pre>
<h3 id="dependencies">Dependencies</h3>
<p>The NGO wrapper uses the following packages.</p>
<ul>
<li><a href="/Extreal.Guide/en/1.0.0/core/logging">Extreal.Core.Logging</a></li>
<li><a href="https://docs-multiplayer.unity3d.com/netcode/current/about/index.html">Netcode for GameObjects</a></li>
<li><a href="https://github.com/Cysharp/UniTask">UniTask</a></li>
<li><a href="https://github.com/neuecc/UniRx">UniRx</a></li>
</ul>
<p>Please refer to <a href="../category/release">Release</a> for the correspondence between module version and each package version.</p>
<h3 id="settings">Settings</h3>
<p>NgoServer and NgoClient are initialized.
Initializing NgoServer and NgoClient requires NetworkManager.
The NetworkManager is set to NgoServer and NgoClient using VContainer.</p>
<p>The NGO NetworkManager is assumed to be initialized by attaching it to a GameObject.</p>
<pre><code class="language-csharp">public class MultiplayServerScope : LifetimeScope
{
    [SerializeField] private NetworkManager networkManager;

    protected override void Configure(IContainerBuilder builder)
    {
        builder.RegisterComponent(networkManager);
        builder.Register&lt;NgoServer&gt;(Lifetime.Singleton);
    }
}
</code></pre>
<pre><code class="language-csharp">public class MultiplayControlScope : LifetimeScope
{
    [SerializeField] private NetworkManager networkManager;

    protected override void Configure(IContainerBuilder builder)
    {
        builder.RegisterComponent(networkManager);
        builder.Register&lt;NgoClient&gt;(Lifetime.Singleton);
    }
}
</code></pre>
<admonition type="tip"><p>NetworkManager needs to be configured the same on server and client, so it should be Prefab and use the same on server and client.</p></admonition>
<admonition type="info"><p>If you want to use a new transport not provided by NGO, please refer to <a href="#int-ngo-nt">Supporting non-default NetworkTransport provided by NGO</a>.
If you use the two transports provided by the NGO (Unity Transport and UNet Transport), no work is required.</p></admonition>
<h2 id="usage">Usage</h2>
<h3 id="use-features-for-ngo-servers">Use features for NGO servers</h3>
<p>The features for NGO servers are provided by NgoServer.
Here are some basic instructions on how to use NgoServer.
Since NgoServer transfers the multiplayer processing to NetworkManager, please refer to the NGO documentation for details on each feature.</p>
<p>The server is started using StartServerAsync.</p>
<pre><code class="language-csharp">ngoServer.StartServerAsync().Forget();
</code></pre>
<p>The server is stopped by StopServerAsync, but StopServerAsync is called in NgoServer&#x27;s Dispose.
When the application is terminated, NgoServer&#x27;s Dispose should be called.</p>
<p>Processing in response to messages from clients is registered with RegisterMessageHandler.
Unregistration is done with UnregisterMessageHandler.
The following code registers and unregisters at the start and end of the server.</p>
<pre><code class="language-csharp">ngoServer.OnServerStarted.Subscribe(_ =&gt;
{
    ngoServer.RegisterMessageHandler(MessageName.PlayerSpawn.ToString(), PlayerSpawnMessageHandler);
}).AddTo(compositeDisposable);

ngoServer.OnServerStopping.Subscribe(_ =&gt;
{
    ngoServer.UnregisterMessageHandler(MessageName.PlayerSpawn.ToString());
}).AddTo(compositeDisposable);
</code></pre>
<p>You can use SpawnAsPlayerObject if you want to spawn a player at an arbitrary time or if you want to dynamically switch the player&#x27;s prefab.
The following code is a response to a message from the client registered with RegisterMessageHandler above.
The player is spawned in response to a message from the client.</p>
<pre><code class="language-csharp">private async void PlayerSpawnMessageHandler(ulong clientId, FastBufferReader messageStream)
{
    if (Logger.IsDebug())
    {
        Logger.LogDebug($&quot;{MessageName.PlayerSpawn}: {clientId}&quot;);
    }
    messageStream.ReadValueSafe(out string avatarAssetName);
    var result = Addressables.LoadAssetAsync&lt;GameObject&gt;(avatarAssetName);
    var playerPrefab = await result.Task;
    ngoServer.SpawnAsPlayerObject(clientId, playerPrefab);
}
</code></pre>
<h3 id="add-a-processing-triggered-by-ngo-server-state">Add a processing triggered by NGO server state</h3>
<p>NgoServer has the following event notifications.</p>
<ul>
<li>OnServerStarted<!-- -->
<ul>
<li>Timing: Immediately after the server starts</li>
<li>Type: IObservable</li>
<li>Parameters: None</li>
</ul>
</li>
<li>OnServerStopping<!-- -->
<ul>
<li>Timing: Just before the server stops</li>
<li>Type: IObservable</li>
<li>Parameters: None</li>
</ul>
</li>
<li>OnClientConnected<!-- -->
<ul>
<li>Timing: Immediately after a client connects</li>
<li>Type: IObservable</li>
<li>Parameters: Connected client ID</li>
</ul>
</li>
<li>OnClientDisconnecting<!-- -->
<ul>
<li>Timing: Just before a client disconnects</li>
<li>Type: IObservable</li>
<li>Parameters: Client ID to be disconnected</li>
</ul>
</li>
<li>OnClientRemoving<!-- -->
<ul>
<li>Timing: Immediately before the client is removed</li>
<li>Type: IObservable</li>
<li>Parameters: Client ID to be removed</li>
</ul>
</li>
</ul>
<p>The following is an example of adding processing at server startup and shutdown</p>
<pre><code class="language-csharp">ngoServer.OnServerStarted.Subscribe(_ =&gt;
{
    ngoServer.RegisterMessageHandler(MessageName.PlayerSpawn.ToString(), PlayerSpawnMessageHandler);
}).AddTo(compositeDisposable);

ngoServer.OnServerStopping.Subscribe(_ =&gt;
{
    ngoServer.UnregisterMessageHandler(MessageName.PlayerSpawn.ToString());
}).AddTo(compositeDisposable);
</code></pre>
<h3 id="use-features-for-ngo-clients">Use features for NGO clients</h3>
<p>NGO client features are provided by NgoClient.
Here are some basic instructions on how to use NgoClient.
NgoClient transfers the multiplayer processing to NetworkManager, so please refer to the NGO documentation for details on each feature.</p>
<p>ConnectAsync is used to connect to the server.
Connection information is specified in NgoConfig.
Since it is assumed that an instance of NgoClient is reused while the application is running, the connection information is specified each time the connection is made.</p>
<pre><code class="language-csharp">var ngoConfig = new NgoConfig();
ngoClient.ConnectAsync(ngoConfig).Forget();
</code></pre>
<p>The default for NgoConfig is as follows.
If timeout is null, it is set to 10 seconds.
TimeoutException is thrown when the timeout period elapses in the connection process.</p>
<pre><code class="language-csharp">public NgoConfig
(
    string address = &quot;127.0.0.1&quot;,
    ushort port = 7777,
    byte[] connectionData = null,
    TimeSpan timeout = null
)
</code></pre>
<p>DisconnectAsync is used to disconnect from the server.</p>
<pre><code class="language-csharp">ngoClient.DisconnectAsync().Forget();
</code></pre>
<p>SendMessage is used to send messages to the server.
The following code sends a message to the server to spawn a player after connecting to the server.</p>
<pre><code class="language-csharp">ngoClient.OnConnected.Subscribe(_ =&gt;
{
    var messageStream = new FastBufferWriter(FixedString64Bytes.UTF8MaxLengthInBytes, Allocator.Temp);
    ngoClient.SendMessage(MessageName.PlayerSpawn.ToString(), messageStream);
}).AddTo(compositeDisposable);
</code></pre>
<h3 id="add-a-processing-triggered-by-ngo-client-state">Add a processing triggered by NGO client state</h3>
<p>NgoClient has the following event notifications.</p>
<ul>
<li>OnConnected<!-- -->
<ul>
<li>Timing: Immediately after connecting to the server</li>
<li>Type: IObservable</li>
<li>Parameters: None</li>
</ul>
</li>
<li>OnDisconnecting<!-- -->
<ul>
<li>Timing: Just before disconnecting from the server</li>
<li>Type: IObservable</li>
<li>Parameters: None</li>
</ul>
</li>
<li>OnUnexpectedDisconnected<!-- -->
<ul>
<li>Timing: Immediately after an unexpected server disconnection occurs</li>
<li>Type: IObservable</li>
<li>Parameters: None</li>
</ul>
</li>
<li>OnConnectionApprovalRejected<!-- -->
<ul>
<li>Timing: Immediately after a connection approval is rejected</li>
<li>Type: IObservable</li>
<li>Parameters: None</li>
</ul>
</li>
</ul>
<p>The following is an example of adding processing immediately after connecting to the server.</p>
<pre><code class="language-csharp">ngoClient.OnConnected.Subscribe(_ =&gt;
{
    var messageStream = new FastBufferWriter(FixedString64Bytes.UTF8MaxLengthInBytes, Allocator.Temp);
    ngoClient.SendMessage(MessageName.PlayerSpawn.ToString(), messageStream);
}).AddTo(compositeDisposable);
</code></pre>
<h3 id="int-ngo-nt">Support non-default NetworkTransport provided by NGO</h3>
<p>NGO can change the transport used for communication.
The NGO wrapper supports the two transports provided by NGO (Unity Transport and UNet Transport), so if you use these two transports, no additional action is required.
If you want to use a new transport that is not provided by NGO, you will need to change the IConnectionSetter used by NgoClient.</p>
<p>Since the part of each transport implementation that holds connection information is not standardized, it is necessary to absorb the differences.
IConnectionSetter is provided to fill in the implementation differences of each transport.</p>
<p>To use a new transport, it is necessary to create a class that implements the IConnectionSetter and set it in NgoClient.
The implementation of IConnectionSetter for UnityTransport is shown below for reference when implementing IConnectionSetter.</p>
<pre><code class="language-csharp">public class UnityTransportConnectionSetter : IConnectionSetter
{
    public Type TargetType =&gt; typeof(UnityTransport);

    public void Set(NetworkTransport networkTransport, NgoConfig ngoConfig)
    {
        var unityTransport = networkTransport as UnityTransport;
        unityTransport.ConnectionData.Address = ngoConfig.Address.Trim();
        unityTransport.ConnectionData.Port = ngoConfig.Port;
        unityTransport.ConnectionData.ServerListenAddress = ngoConfig.Address.Trim();
    }
}
</code></pre>
<p>Set the implemented class with NgoClient&#x27;s AddConnectionSetter.</p>
<pre><code class="language-csharp">ngoClient.AddConnectionSetter(new UnityTransportConnectionSetter());
</code></pre></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Extreal.Guide/en/1.0.0/integration/chat.vivox"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Chat using Vivox</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Extreal.Guide/en/1.0.0/category/sample-application"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sample Application</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-for" class="table-of-contents__link toc-highlight">What for?</a></li><li><a href="#specification" class="table-of-contents__link toc-highlight">Specification</a></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a><ul><li><a href="#package" class="table-of-contents__link toc-highlight">Package</a></li><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#settings" class="table-of-contents__link toc-highlight">Settings</a></li></ul></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#use-features-for-ngo-servers" class="table-of-contents__link toc-highlight">Use features for NGO servers</a></li><li><a href="#add-a-processing-triggered-by-ngo-server-state" class="table-of-contents__link toc-highlight">Add a processing triggered by NGO server state</a></li><li><a href="#use-features-for-ngo-clients" class="table-of-contents__link toc-highlight">Use features for NGO clients</a></li><li><a href="#add-a-processing-triggered-by-ngo-client-state" class="table-of-contents__link toc-highlight">Add a processing triggered by NGO client state</a></li><li><a href="#int-ngo-nt" class="table-of-contents__link toc-highlight">Support non-default NetworkTransport provided by NGO</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">License</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Apache License 2.0<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Feedback</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/extreal-dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Used by</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.buralit.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">BURALIT<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item">
                    <a class="footer__link-item" href="javascript:void(0);" onclick="goTermsOfUse()">Terms of Use</a>
                </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 TIS, Inc. Built with Docusaurus.<br><small>The names of products or services appearing on this site are trademarks or registered trademarks of the respective companies.</small></div></div></div></footer></div>
</body>
</html>